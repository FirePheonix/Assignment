{% extends "website/base.html" %}
{% load static %}
{% block title %}Create New Task - Gemnar{% endblock %}
{% block extra_css %}
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
          rel="stylesheet">
    <style>
        /* Scoped styles for task creation form only */
        #task-create-container {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        #task-create-container .form-progress {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #d53369, #daae51);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        /* Form Card */
        #task-create-container .form-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
            border: 1px solid #e5e7eb;
            overflow: hidden;
            margin-bottom: 2rem;
        }

        /* Section Styling */
        #task-create-container .form-section {
            padding: 2rem;
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.3s ease;
        }

        #task-create-container .form-section:last-child {
            border-bottom: none;
        }

        #task-create-container .form-section:hover {
            background: #fafbfc;
        }

        /* Section Headers */
        #task-create-container .section-header {
            margin-bottom: 2rem;
        }

        #task-create-container .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        #task-create-container .section-title i {
            color: #d53369;
            font-size: 1.25rem;
        }

        #task-create-container .section-subtitle {
            color: #64748b;
            font-size: 1rem;
            font-weight: 400;
        }

        /* Form Groups and Grid */
        #task-create-container .form-group {
            margin-bottom: 1.5rem;
        }

        #task-create-container .form-grid {
            display: grid;
            gap: 1.5rem;
        }

        #task-create-container .form-grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }

        /* Form Labels */
        #task-create-container .form-label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        #task-create-container .required {
            color: #ef4444;
            margin-left: 2px;
        }

        /* Form Inputs */
        #task-create-container .form-input,
        #task-create-container .form-select,
        #task-create-container .form-textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
            color: #1f2937;
        }

        #task-create-container .form-input:focus,
        #task-create-container .form-select:focus,
        #task-create-container .form-textarea:focus {
            outline: none;
            border-color: #d53369;
            box-shadow: 0 0 0 4px rgba(213, 51, 105, 0.1);
            transform: translateY(-1px);
        }

        #task-create-container .form-textarea {
            min-height: 120px;
            resize: vertical;
            padding-bottom: 2.5rem;
        }

        #task-create-container .form-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.75rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }

        /* Input Groups */
        #task-create-container .input-group {
            position: relative;
        }

        #task-create-container .input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
            z-index: 1;
        }

        #task-create-container .input-group .form-input {
            padding-left: 2.5rem;
        }

        /* Help Text */
        #task-create-container .help-text {
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: #6b7280;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        #task-create-container .help-text i {
            color: #9ca3af;
            font-size: 0.75rem;
        }

        /* Conditional Sections */
        #task-create-container .conditional-section {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease, padding 0.3s ease, margin 0.3s ease;
            margin-top: 0;
        }

        #task-create-container .conditional-section.show {
            max-height: 300px;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #e5e7eb;
        }

        /* Character Counter */
        #task-create-container .form-textarea-wrapper {
            position: relative;
        }

        #task-create-container .char-counter {
            position: absolute;
            bottom: 0.75rem;
            right: 1rem;
            font-size: 0.75rem;
            color: #6b7280;
            background: rgba(255, 255, 255, 0.95);
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-weight: 500;
        }

        #task-create-container .char-counter.warning {
            color: #f59e0b;
            background: rgba(251, 191, 36, 0.1);
        }

        #task-create-container .char-counter.error {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        /* Buttons */
        #task-create-container .btn-primary {
            background: linear-gradient(135deg, #d53369 0%, #daae51 100%);
            border: none;
            color: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        #task-create-container .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(213, 51, 105, 0.3);
        }

        #task-create-container .btn-secondary {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            color: #64748b;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        #task-create-container .btn-secondary:hover {
            background: #e2e8f0;
            color: #475569;
            transform: translateY(-1px);
        }

        /* Alert Styles */
        #task-create-container .alert {
            padding: 1rem 1.5rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 500;
        }

        #task-create-container .alert.success {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #15803d;
        }

        #task-create-container .alert.error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
        }

        /* Validation States */
        #task-create-container .success-state {
            border-color: #10b981 !important;
            background-color: #f0fdf4 !important;
        }

        #task-create-container .error-state {
            border-color: #ef4444 !important;
            background-color: #fef2f2 !important;
        }

        /* Animations */
        #task-create-container .error-message {
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Form Actions */
        #task-create-container .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            padding: 2rem;
            background: #f8fafc;
            border-top: 1px solid #e5e7eb;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            #task-create-container .form-grid-3 {
                grid-template-columns: 1fr;
            }
            
            #task-create-container .form-actions {
                flex-direction: column-reverse;
            }
            
            #task-create-container .btn-primary,
            #task-create-container .btn-secondary {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
{% endblock %}
{% block content %}
    <!-- Progress Indicator -->
    <div class="form-progress" id="form-progress"></div>
    <!-- Main Content Container with White Background -->
    <div id="task-create-container" class="bg-white min-h-screen">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <!-- Breadcrumbs -->
            <nav class="flex mb-6" aria-label="Breadcrumb">
                <ol class="inline-flex items-center space-x-1 md:space-x-3">
                    <li class="inline-flex items-center">
                        <a href="{% url 'website:landing' %}"
                           class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 transition-colors">
                            <i class="fas fa-home mr-2"></i>
                            Dashboard
                        </a>
                    </li>
                    <li>
                        <div class="flex items-center">
                            <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
                            <a href="{% url 'website:active_tasks_dashboard' %}"
                               class="text-sm font-medium text-gray-700 hover:text-blue-600 transition-colors">
                                Active Tasks
                            </a>
                        </div>
                    </li>
                    <li aria-current="page">
                        <div class="flex items-center">
                            <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
                            <span class="text-sm font-medium text-gray-500">Create New Task</span>
                        </div>
                    </li>
                </ol>
            </nav>
            <!-- Page Header -->
            <div class="mb-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Create New Task</h1>
                        <p class="text-gray-600 text-sm">Design a compelling task that attracts the right creators</p>
                    </div>
                    <div>
                        <a href="{% url 'website:active_tasks_dashboard' %}"
                           class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors inline-flex items-center">
                            <i class="fas fa-arrow-left mr-2"></i>Back to Tasks
                        </a>
                    </div>
                </div>
            </div>
            <!-- Main Form Card -->
            <div class="form-card">
                <!-- Alert Container -->
                <div id="alert-container" class="p-6"></div>
                <!-- Form -->
                <form id="task-form" method="post">
                    {% csrf_token %}
                    <!-- Basic Information -->
                    <div class="form-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-info-circle"></i>
                                Basic Information
                            </h2>
                            <p class="section-subtitle">Provide essential details about your task</p>
                        </div>
                        <div class="form-group">
                            <label for="title" class="form-label">
                                Task Title <span class="required">*</span>
                            </label>
                            <input type="text"
                                   id="title"
                                   name="title"
                                   class="form-input"
                                   required
                                   placeholder="Enter a clear, descriptive title for your task">
                            <div class="help-text">
                                <i class="fas fa-lightbulb"></i>
                                Make it specific and engaging to attract the right creators
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="description" class="form-label">
                                Task Description <span class="required">*</span>
                            </label>
                            <div class="form-textarea-wrapper">
                                <textarea id="description"
                                          name="description"
                                          class="form-textarea"
                                          required
                                          placeholder="Provide detailed instructions, requirements, and expectations for creators..."
                                          maxlength="2000"></textarea>
                                <div class="char-counter" id="description-counter">0/2000</div>
                            </div>
                            <div class="help-text">
                                <i class="fas fa-clipboard-list"></i>
                                Include all relevant details about what you expect from creators
                            </div>
                        </div>
                    </div>
                    <!-- Task Categories -->
                    <div class="form-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-tags"></i>
                                Task Categories
                            </h2>
                            <p class="section-subtitle">Define the type of content and compensation</p>
                        </div>
                        <div class="form-grid form-grid-3">
                            <div class="form-group">
                                <label for="category" class="form-label">
                                    Content Category <span class="required">*</span>
                                </label>
                                <select id="category" name="category" class="form-select" required>
                                    <option value="">Select Category</option>
                                    {% for value, label in category_choices %}<option value="{{ value }}">{{ label }}</option>{% endfor %}
                                </select>
                                <div class="help-text">
                                    <i class="fas fa-camera"></i>
                                    Type of content to be created
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="genre" class="form-label">
                                    Content Genre <span class="required">*</span>
                                </label>
                                <select id="genre" name="genre" class="form-select" required>
                                    <option value="">Select Genre</option>
                                    {% for value, label in genre_choices %}<option value="{{ value }}">{{ label }}</option>{% endfor %}
                                </select>
                                <div class="help-text">
                                    <i class="fas fa-industry"></i>
                                    Industry or niche for the content
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="incentive_type" class="form-label">
                                    Incentive Type <span class="required">*</span>
                                </label>
                                <select id="incentive_type"
                                        name="incentive_type"
                                        class="form-select"
                                        required>
                                    <option value="">Select Incentive</option>
                                    {% for value, label in incentive_choices %}<option value="{{ value }}">{{ label }}</option>{% endfor %}
                                </select>
                                <div class="help-text">
                                    <i class="fas fa-handshake"></i>
                                    How creators will be compensated
                                </div>
                            </div>
                        </div>
                        <!-- Conditional Fields -->
                        <div id="barter-details" class="conditional-section">
                            <div class="form-group">
                                <label for="barter_details" class="form-label">
                                    Product Details <span class="required">*</span>
                                </label>
                                <textarea id="barter_details"
                                          name="barter_details"
                                          class="form-textarea"
                                          placeholder="Describe the products or services you're offering in exchange..."></textarea>
                                <div class="help-text">
                                    <i class="fas fa-gift"></i>
                                    Be specific about what creators will receive (value, quantity, shipping, etc.)
                                </div>
                            </div>
                        </div>
                        <div id="pay-amount" class="conditional-section payment">
                            <div class="form-group">
                                <label for="pay_amount" class="form-label">
                                    Payment Amount (USD) <span class="required">*</span>
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-dollar-sign"></i>
                                    <input type="number"
                                           id="pay_amount"
                                           name="pay_amount"
                                           class="form-input"
                                           step="0.01"
                                           min="0.01"
                                           placeholder="0.00">
                                </div>
                                <div class="help-text">
                                    <i class="fas fa-calculator"></i>
                                    Amount you'll pay per creator for completing the task
                                </div>
                            </div>
                        </div>
                        <div id="commission-percentage" class="conditional-section payment">
                            <div class="form-group">
                                <label for="commission_percentage" class="form-label">
                                    Commission Percentage <span class="required">*</span>
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-percentage"></i>
                                    <input type="number"
                                           id="commission_percentage"
                                           name="commission_percentage"
                                           class="form-input"
                                           step="0.1"
                                           min="0.1"
                                           max="100"
                                           placeholder="0.0">
                                </div>
                                <div class="help-text">
                                    <i class="fas fa-chart-line"></i>
                                    Percentage of sales creators will earn from referrals/sales
                                </div>
                            </div>
                        </div>
                        <div id="gift-card-amount" class="conditional-section payment">
                            <div class="form-group">
                                <label for="gift_card_amount" class="form-label">
                                    Gift Card Amount (USD) <span class="required">*</span>
                                </label>
                                <div class="input-group">
                                    <i class="input-icon fas fa-credit-card"></i>
                                    <input type="number"
                                           id="gift_card_amount"
                                           name="gift_card_amount"
                                           class="form-input"
                                           step="0.01"
                                           min="0.01"
                                           placeholder="0.00">
                                </div>
                                <div class="help-text">
                                    <i class="fas fa-gift-card"></i>
                                    Value of the gift card you'll provide to creators
                                </div>
                            </div>
                        </div>
                        <div id="experience-details" class="conditional-section">
                            <div class="form-group">
                                <label for="experience_details" class="form-label">
                                    Experience Details <span class="required">*</span>
                                </label>
                                <textarea id="experience_details"
                                          name="experience_details"
                                          class="form-textarea"
                                          placeholder="Describe the experience, event access, or opportunity you're offering..."></textarea>
                                <div class="help-text">
                                    <i class="fas fa-calendar-alt"></i>
                                    Include details about dates, location, what's included, and any restrictions
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Additional Settings -->
                    <div class="form-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-cog"></i>
                                Additional Settings
                            </h2>
                            <p class="section-subtitle">Optional settings to customize your task</p>
                        </div>
                        <div class="form-group">
                            <label for="deadline" class="form-label">Deadline (Optional)</label>
                            <input type="datetime-local"
                                   id="deadline"
                                   name="deadline"
                                   class="form-input">
                            <div class="help-text">
                                <i class="fas fa-clock"></i>
                                When creators should complete the task
                            </div>
                        </div>
                    </div>
                </form>
                <!-- Form Actions -->
                <div class="form-actions">
                    <a href="{% url 'website:active_tasks_dashboard' %}"
                       class="btn-secondary">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </a>
                    <button type="submit" form="task-form" class="btn-primary" id="submit-btn">
                        <i class="fas fa-plus mr-2"></i>Create Task
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Task create page loaded');
        
        const incentiveSelect = document.getElementById('incentive_type');
        const barterDetails = document.getElementById('barter-details');
        const payAmount = document.getElementById('pay-amount');
        const commissionPercentage = document.getElementById('commission-percentage');
        const giftCardAmount = document.getElementById('gift-card-amount');
        const experienceDetails = document.getElementById('experience-details');
        const form = document.getElementById('task-form');
        const submitBtn = document.getElementById('submit-btn');
        const alertContainer = document.getElementById('alert-container');
        
        console.log('Form element found:', form);
        console.log('Submit button found:', submitBtn);
        console.log('Alert container found:', alertContainer);
        
        // Show/hide conditional fields based on incentive type
        function toggleConditionalFields() {
            const selectedValue = incentiveSelect.value;
            
            // Hide all conditional fields first
            [barterDetails, payAmount, commissionPercentage, giftCardAmount, experienceDetails].forEach(section => {
                section.classList.remove('show');
                setTimeout(() => {
                    section.style.display = 'none';
                }, 200);
            });
            
            // Clear required attributes
            document.getElementById('barter_details').removeAttribute('required');
            document.getElementById('pay_amount').removeAttribute('required');
            document.getElementById('commission_percentage').removeAttribute('required');
            document.getElementById('gift_card_amount').removeAttribute('required');
            document.getElementById('experience_details').removeAttribute('required');
            
            // Show relevant field and set required attribute with animation
            let targetSection = null;
            let targetInput = null;
            
            if (selectedValue === 'BARTER') {
                targetSection = barterDetails;
                targetInput = 'barter_details';
            } else if (selectedValue === 'PAY') {
                targetSection = payAmount;
                targetInput = 'pay_amount';
            } else if (selectedValue === 'COMMISSION') {
                targetSection = commissionPercentage;
                targetInput = 'commission_percentage';
            } else if (selectedValue === 'GIFT_CARD') {
                targetSection = giftCardAmount;
                targetInput = 'gift_card_amount';
            } else if (selectedValue === 'EXPERIENCE') {
                targetSection = experienceDetails;
                targetInput = 'experience_details';
            }
            
            if (targetSection && targetInput) {
                targetSection.style.display = 'block';
                setTimeout(() => {
                    targetSection.classList.add('show');
                    document.getElementById(targetInput).setAttribute('required', 'required');
                }, 50);
            }
            
            updateProgress();
        }
        
        // Listen for changes to incentive type
        incentiveSelect.addEventListener('change', toggleConditionalFields);
        
        // Initialize on page load
        toggleConditionalFields();
        
        // Character counter for description
        const descriptionField = document.getElementById('description');
        const descriptionCounter = document.getElementById('description-counter');
        
        function updateCharCounter() {
            const currentLength = descriptionField.value.length;
            const maxLength = descriptionField.getAttribute('maxlength');
            descriptionCounter.textContent = `${currentLength}/${maxLength}`;
            
            if (currentLength > maxLength * 0.9) {
                descriptionCounter.style.color = '#ef4444';
            } else if (currentLength > maxLength * 0.7) {
                descriptionCounter.style.color = '#f59e0b';
            } else {
                descriptionCounter.style.color = '#9ca3af';
            }
        }
        
        descriptionField.addEventListener('input', updateCharCounter);
        
        // Progress tracking
        function updateProgress() {
            const formElements = form.querySelectorAll('input[required], select[required], textarea[required]');
            let filledCount = 0;
            
            formElements.forEach(element => {
                if (element.value.trim() !== '') {
                    filledCount++;
                }
            });
            
            const progress = (filledCount / formElements.length) * 100;
            document.getElementById('form-progress').style.width = progress + '%';
        }
        
        // Add input listeners for progress tracking
        form.addEventListener('input', updateProgress);
        form.addEventListener('change', updateProgress);
        
        // Enhanced form validation
        function validateField(field) {
            const value = field.value.trim();
            const fieldType = field.type;
            const isRequired = field.hasAttribute('required');
            
            // Remove existing validation classes
            field.classList.remove('success', 'error');
            
            if (isRequired && !value) {
                field.classList.add('error');
                return false;
            }
            
            // Type-specific validation
            if (fieldType === 'number' && value) {
                const numValue = parseFloat(value);
                if (isNaN(numValue) || numValue <= 0) {
                    field.classList.add('error');
                    return false;
                }
            }
            
            if (value) {
                field.classList.add('success');
            }
            
            return true;
        }
        
        // Add validation listeners
        const formFields = form.querySelectorAll('input, select, textarea');
        formFields.forEach(field => {
            field.addEventListener('blur', () => validateField(field));
            field.addEventListener('input', () => {
                if (field.classList.contains('error')) {
                    validateField(field);
                }
            });
        });
        
        // Handle form submission
        if (form) {
            console.log('Adding submit event listener to form');
            form.addEventListener('submit', function(e) {
                console.log('Form submit event triggered!');
                e.preventDefault();
            
            // Clear previous alerts
            alertContainer.innerHTML = '';
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Creating Task...';
            submitBtn.disabled = true;
            form.classList.add('loading');
            
            // Prepare form data
            const formData = new FormData(form);
            
            // Submit form via AJAX
            console.log('Submitting form to:', window.location.href);
            console.log('Form data:', Object.fromEntries(formData));
            
            fetch(window.location.href, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                }
            })
            .then(response => {
                console.log('Response status:', response.status);
                console.log('Response headers:', response.headers);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                return response.json();
            })
            .then(data => {
                console.log('Response data:', data);
                
                if (data.success) {
                    // Show success message
                    showAlert('Task created successfully! Redirecting...', 'success');
                    
                    // Redirect after a short delay
                    setTimeout(() => {
                        window.location.href = data.redirect_url;
                    }, 1500);
                } else {
                    // Show error message
                    showAlert(data.error || 'An error occurred while creating the task.', 'error');
                    resetForm();
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                showAlert('An unexpected error occurred. Please try again.', 'error');
                resetForm();
            });
        } else {
            console.error('Form element not found! Cannot add submit event listener.');
        }
        
        // Also add click event listener to button as backup
        if (submitBtn) {
            console.log('Adding click event listener to submit button');
            submitBtn.addEventListener('click', function(e) {
                console.log('Submit button clicked!');
                if (form) {
                    console.log('Manually triggering form submit');
                    form.dispatchEvent(new Event('submit', { cancelable: true, bubbles: true }));
                } else {
                    console.error('Form not found when button clicked');
                }
            });
        } else {
            console.error('Submit button not found!');
        }
        
        function showAlert(message, type) {
            const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
            const icon = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-triangle';
            
            alertContainer.innerHTML = `
                <div class="alert ${alertClass}">
                    <i class="${icon}"></i>${message}
                </div>
            `;
        }
        
        function resetForm() {
            submitBtn.innerHTML = '<i class="fas fa-plus mr-2"></i>Create Task';
            submitBtn.disabled = false;
            form.classList.remove('loading');
        }
    });
    </script>
{% endblock %}
