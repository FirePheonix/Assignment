(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2433],{19377:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var a=s(12115),r=s(84335),l=s(18720);function i(){let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)(!0),[n,d]=(0,a.useState)(null),o=(0,a.useCallback)(async()=>{try{i(!0);let e=await r.v.getBrands();t(e);let s=e.find(e=>e.is_default);d(s||null)}catch(e){console.error("Failed to fetch brands:",e),l.oR.error("Failed to fetch brands")}finally{i(!1)}},[]),c=(0,a.useCallback)(async s=>{try{let a=await r.v.createBrand(s);return t(e=>[...e,a]),0===e.length&&d(a),l.oR.success("Brand created successfully"),a}catch(e){throw console.error("Failed to create brand:",e),l.oR.error(e.message||"Failed to create brand"),e}},[e.length]),m=(0,a.useCallback)(async(e,s)=>{try{let a=await r.v.updateBrand(e,s);return t(t=>t.map(t=>t.id===e?a:t)),(null==n?void 0:n.id)===e&&d(a),l.oR.success("Brand updated successfully"),a}catch(e){throw console.error("Failed to update brand:",e),l.oR.error(e.message||"Failed to update brand"),e}},[null==n?void 0:n.id]),u=(0,a.useCallback)(async s=>{try{await r.v.setDefaultBrand(s),t(e=>e.map(e=>({...e,is_default:e.id===s})));let a=e.find(e=>e.id===s);d(a||null),l.oR.success("Default brand updated")}catch(e){console.error("Failed to set default brand:",e),l.oR.error(e.message||"Failed to set default brand")}},[e]);return(0,a.useEffect)(()=>{o()},[o]),{brands:e,defaultBrand:n,isLoading:s,createBrand:c,updateBrand:m,setDefault:u,refetch:o}}},26983:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},74971:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var a=s(95155),r=s(6191),l=s(71360),i=s(11010),n=s(67161),d=s(6132),o=s(26983),c=s(16485),m=s(42529),u=s(93499),x=s(85921),h=s(12115),g=s(93449),p=s(19377),b=s(56514),f=s(52619),v=s.n(f),j=s(18720);function N(){let{brands:e=[],isLoading:t}=(0,p.E)(),{posts:s=[],isLoading:f=!1,createPost:N,updatePost:y,deletePost:w,postNow:_,refetch:k}=(0,g.jC)(void 0),[C,A]=(0,h.useState)(!1),[P,F]=(0,h.useState)(!1),[D,S]=(0,h.useState)(null),[R,I]=(0,h.useState)({caption:"",image:"",scheduled_time:"",brand_id:0}),T=(e||[]).filter(e=>!!e.instagram_connected),B=(0,h.useMemo)(()=>{let e=s.filter(e=>"approved"===e.status).length,t=s.filter(e=>"posted"===e.status).length,a=s.filter(e=>"draft"===e.status).length;return{total:s.length,approved:e,posted:t,drafts:a}},[s]),E=e=>{if(!e)return"";let t=new Date(e);if(isNaN(t.getTime()))return"";let s=e=>String(e).padStart(2,"0"),a=t.getFullYear(),r=s(t.getMonth()+1),l=s(t.getDate()),i=s(t.getHours()),n=s(t.getMinutes());return"".concat(a,"-").concat(r,"-").concat(l,"T").concat(i,":").concat(n)};(0,h.useEffect)(()=>{},[t]);let L=async()=>{if(!R.caption.trim())return void j.oR.error("Please enter a caption");if(!R.image)return void j.oR.error("Please select an image");if(!R.brand_id)return void j.oR.error("Please select a brand");try{let e={caption:R.caption,imageUrl:R.image,brand_id:R.brand_id};R.scheduled_time&&(e.scheduled_time=R.scheduled_time),await N(e),j.oR.success("Post created successfully!"),I({caption:"",image:"",scheduled_time:"",brand_id:0}),A(!1),F(!1),null==k||k()}catch(e){console.error("Failed to create post:",e),j.oR.error("Failed to create post")}},U=async()=>{if(D){if(!R.caption.trim())return void j.oR.error("Please enter a caption");if(!R.brand_id)return void j.oR.error("Please select a brand");try{var e,t,s;let a={caption:R.caption,brand_id:R.brand_id};R.image&&R.image!==(null!=(e=D.image)?e:"")&&(a.imageUrl=R.image);let r=E(null!=(s=null!=(t=D.scheduled_for)?t:D.scheduled_time)?s:void 0);R.scheduled_time!==r&&(a.scheduled_time=R.scheduled_time||void 0),await y(D.id,a),j.oR.success("Post updated successfully!"),S(null),I({caption:"",image:"",scheduled_time:"",brand_id:0}),A(!1),F(!1),null==k||k()}catch(e){console.error("Failed to update post:",e),j.oR.error("Failed to update post")}}},M=()=>{S(null),I({caption:"",image:"",scheduled_time:"",brand_id:0}),A(!1),F(!1)},O=async e=>{if(confirm("Are you sure you want to post this to Instagram now?"))try{await _(e),null==k||k()}catch(e){console.error("Post now failed:",e),alert("Failed to post now")}},W=async e=>{if(confirm("Are you sure you want to delete this post?"))try{await w(e),null==k||k()}catch(e){console.error("Delete failed:",e),alert("Failed to delete post")}},q=e=>{if(!e)return"";let t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleString()};return(0,a.jsxs)("div",{className:"p-8 bg-black min-h-screen",children:[(0,a.jsx)("div",{className:"background-pattern-blue"}),(0,a.jsxs)("div",{className:"mb-6 relative z-10",children:[(0,a.jsxs)("nav",{className:"text-sm text-gray-400 mb-2",children:[(0,a.jsx)(v(),{href:"/dashboard",className:"hover:text-white transition-colors",children:"Dashboard"}),(0,a.jsx)("span",{className:"mx-2",children:"→"}),(0,a.jsx)(v(),{href:"/dashboard/brands",className:"hover:text-white transition-colors",children:"Brands"}),(0,a.jsx)("span",{className:"mx-2",children:"→"}),(0,a.jsx)("span",{className:"text-purple-400",children:"Instagram Queue"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Instagram Post Queue"}),(0,a.jsx)("p",{className:"text-gray-400",children:"All scheduled Instagram posts across all your brands"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(v(),{href:"/dashboard/instagram/connect",className:"bg-white/5 border border-white/10 hover:bg-white/10 text-white py-2 px-4 rounded-lg transition-colors",children:"Connections"}),(0,a.jsx)("button",{onClick:()=>A(!0),disabled:0===T.length,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:opacity-90 disabled:opacity-50 text-white font-medium py-2 px-4 rounded-lg transition-opacity",children:"Create Post"})]})]})]}),(0,a.jsx)("div",{className:"bg-[#1a1a1a] border border-white/10 rounded-xl p-6 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-400",children:B.total}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Total Posts"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-500",children:B.posted}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Posted"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-500",children:B.approved}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Approved"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-500",children:B.drafts}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Drafts"})]})]})}),!C&&(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("button",{onClick:()=>A(!0),className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:opacity-90 text-white font-medium py-3 px-6 rounded-lg transition flex items-center gap-2",children:[(0,a.jsx)(r.A,{className:"w-4 h-4"}),"Create New Post"]})}),C&&(0,a.jsxs)("div",{className:"bg-[#1a1a1a] border border-white/10 rounded-xl p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:D?"Edit Post":"Create New Post"}),(0,a.jsx)("button",{onClick:M,className:"text-gray-400 hover:text-white",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Caption"}),(0,a.jsx)("textarea",{rows:4,maxLength:2200,value:R.caption,onChange:e=>I(t=>({...t,caption:e.target.value})),className:"w-full p-3 bg-black border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Write your caption..."}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[R.caption.length," / 2200 characters"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Media"}),(0,a.jsxs)("div",{className:"space-y-3",children:[R.image?(0,a.jsxs)("div",{className:"relative aspect-square",children:[R.image.match(/\.(mp4|mov|avi|webm)$/i)?(0,a.jsx)("video",{src:R.image,controls:!0,className:"w-full h-full object-cover rounded-lg border border-white/10"}):(0,a.jsx)("img",{src:R.image,alt:"Preview",className:"w-full h-full object-cover rounded-lg border border-white/10"}),(0,a.jsx)("button",{onClick:()=>I(e=>({...e,image:""})),className:"absolute top-2 right-2 p-1.5 bg-red-500 rounded-full text-white hover:bg-red-600 transition",children:(0,a.jsx)(l.A,{className:"w-4 h-4"})})]}):(0,a.jsx)(b.a,{currentImage:R.image,onImageUpload:e=>I(t=>({...t,image:e})),className:"aspect-square"}),(0,a.jsxs)("button",{onClick:()=>F(!P),className:"w-full text-purple-400 hover:text-purple-300 text-sm py-2 border border-purple-400/30 rounded-lg hover:bg-purple-500/10 transition",type:"button",children:[P?"Hide":"Show"," Image Library"]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Brand"}),(0,a.jsxs)("select",{value:R.brand_id,onChange:e=>I(t=>({...t,brand_id:Number(e.target.value)})),className:"w-full p-3 bg-black border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500",disabled:!!D,children:[(0,a.jsx)("option",{value:0,disabled:!0,children:"-- Select Brand --"}),e.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," ",e.has_instagram_config?"✓":"(not connected)"]},e.id))]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:D?"Brand cannot be changed when editing":"Select a brand to create a post"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Schedule For (Optional)"}),(0,a.jsx)("input",{type:"datetime-local",value:R.scheduled_time,onChange:e=>I(t=>({...t,scheduled_time:e.target.value})),min:new Date().toISOString().slice(0,16),className:"w-full p-3 bg-black border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to save as draft"})]})]})]}),P&&(0,a.jsx)(b.i,{selectedImage:R.image,onImageSelect:e=>{I(t=>({...t,image:e})),F(!1)},showUpload:!1}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:D?U:L,disabled:!R.caption.trim()||!R.image||!R.brand_id,className:"bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium transition flex items-center gap-2",children:[D?(0,a.jsx)(i.A,{className:"w-4 h-4"}):(0,a.jsx)(r.A,{className:"w-4 h-4"}),D?"Update Post":"Create Post"]}),(0,a.jsx)("button",{onClick:M,className:"bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg font-medium transition",children:"Cancel"})]})]})]}),(0,a.jsx)("div",{className:"space-y-6",children:f?(0,a.jsxs)("div",{className:"text-center py-12 bg-[#1a1a1a] border border-white/10 rounded-xl",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Loading posts..."})]}):0===s.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-[#1a1a1a] border border-white/10 rounded-xl",children:[(0,a.jsx)(n.A,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-400 mb-2",children:"No posts yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"Create your first Instagram post to get started"}),(0,a.jsxs)("button",{onClick:()=>A(!0),className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:opacity-90 text-white px-6 py-3 rounded-lg font-medium transition inline-flex items-center gap-2",children:[(0,a.jsx)(r.A,{className:"w-4 h-4"}),"Create Post"]})]}):(()=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(t.getTime()+864e5),h=new Date(t.getTime()+6048e5),g={overdue:[],today:[],tomorrow:[],thisWeek:[],later:[],posted:[],drafts:[]};s.forEach(t=>{if("posted"===t.status)g.posted.push(t);else if(t.scheduled_for||t.scheduled_time){let s=new Date(t.scheduled_for||t.scheduled_time||"");isNaN(s.getTime())?g.drafts.push(t):s<e?g.overdue.push(t):s<r?g.today.push(t):s<new Date(r.getTime()+864e5)?g.tomorrow.push(t):s<h?g.thisWeek.push(t):g.later.push(t)}else g.drafts.push(t)});let p=[{key:"overdue",title:"Overdue",color:"text-red-400",icon:d.A},{key:"today",title:"Today",color:"text-green-400",icon:o.A},{key:"tomorrow",title:"Tomorrow",color:"text-blue-400",icon:c.A},{key:"thisWeek",title:"This Week",color:"text-purple-400",icon:c.A},{key:"later",title:"Later",color:"text-gray-400",icon:c.A},{key:"posted",title:"Posted",color:"text-green-400",icon:m.A},{key:"drafts",title:"Drafts",color:"text-gray-400",icon:i.A}];return(0,a.jsx)(a.Fragment,{children:p.map(e=>{let t=g[e.key];if(0===t.length)return null;let s=e.icon;return(0,a.jsxs)("div",{className:"bg-[#1a1a1a] border border-white/10 rounded-xl p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)(s,{className:"w-5 h-5 ".concat(e.color)}),(0,a.jsx)("h3",{className:"text-lg font-semibold ".concat(e.color),children:e.title}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["(",t.length,")"]})]}),(0,a.jsx)("div",{className:"space-y-3",children:t.map(e=>{var t,s,r,d,c;return(0,a.jsx)("div",{className:"bg-black border border-white/10 rounded-lg p-4 hover:border-purple-500/50 transition",children:(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden bg-gray-900",children:e.image?e.image.match(/\.(mp4|mov|avi|webm)$/i)?(0,a.jsx)("video",{src:e.image,className:"w-full h-full object-cover",muted:!0,playsInline:!0}):(0,a.jsx)("img",{src:e.image,alt:"Post",className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)(n.A,{className:"w-8 h-8 text-gray-600"})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-xs font-bold",children:null!=(d=null==(s=e.brand)||null==(t=s.name)?void 0:t.substring(0,1).toUpperCase())?d:"?"}),(0,a.jsx)("span",{className:"text-sm font-medium text-white",children:null!=(c=null==(r=e.brand)?void 0:r.name)?c:"Unknown"}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat((e=>{switch(e){case"posted":return"text-green-400 bg-green-500/20";case"approved":case"scheduled":return"text-blue-400 bg-blue-500/20";case"draft":default:return"text-gray-400 bg-gray-500/20";case"failed":return"text-red-400 bg-red-500/20"}})(e.status)),children:e.status||"unknown"})]}),e.instagram_url&&(0,a.jsxs)("a",{href:e.instagram_url,target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 hover:text-purple-300 flex items-center gap-1 text-xs",children:[(0,a.jsx)(u.A,{className:"w-3 h-3"}),"View"]})]}),(0,a.jsx)("p",{className:"text-gray-300 text-sm mb-2 line-clamp-2",children:e.content||e.caption||"No caption"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500 mb-3",children:[(e.scheduled_for||e.scheduled_time)&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(o.A,{className:"w-3 h-3"}),q(e.scheduled_for||e.scheduled_time)]}),e.posted_at&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(m.A,{className:"w-3 h-3"}),"Posted ",q(e.posted_at)]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["posted"!==e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>O(e.id),className:"text-green-400 hover:text-green-300 text-xs px-3 py-1.5 rounded bg-green-500/10 hover:bg-green-500/20 transition flex items-center gap-1",children:[(0,a.jsx)(x.A,{className:"w-3 h-3"}),"Post Now"]}),(0,a.jsxs)("button",{onClick:()=>{var t,s,a,r,l,i,n;S(e),I({caption:null!=(a=null!=(s=e.content)?s:e.caption)?a:"",image:null!=(r=e.image)?r:"",scheduled_time:E(null!=(i=null!=(l=e.scheduled_for)?l:e.scheduled_time)?i:void 0),brand_id:null!=(n=null==(t=e.brand)?void 0:t.id)?n:0}),A(!0),F(!1)},className:"text-blue-400 hover:text-blue-300 text-xs px-3 py-1.5 rounded bg-blue-500/10 hover:bg-blue-500/20 transition flex items-center gap-1",children:[(0,a.jsx)(i.A,{className:"w-3 h-3"}),"Edit"]})]}),(0,a.jsxs)("button",{onClick:()=>W(e.id),className:"text-red-400 hover:text-red-300 text-xs px-3 py-1.5 rounded bg-red-500/10 hover:bg-red-500/20 transition flex items-center gap-1",children:[(0,a.jsx)(l.A,{className:"w-3 h-3"}),"Delete"]})]})]})]})},e.id)})})]},e.key)})})})()})]})}},77930:(e,t,s)=>{Promise.resolve().then(s.bind(s,74971))}},e=>{e.O(0,[297,8720,3864,8441,1255,7358],()=>e(e.s=77930)),_N_E=e.O()}]);